{"version":3,"sources":["node_modules/browser-pack/_prelude.js","Scripts/Utilities/DomUtil.ts","Scripts/Utilities/HtmlLoader.ts","Scripts/Utilities/MakeRequest.ts","Scripts/Utilities/UrlUtil.ts","Scripts/Vendor/tingle/dist/tingle.js","Scripts/main.ts"],"names":[],"mappings":"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AuB,GAA3B,GAAkC,MAAM,CAAC,QAAP,CAAgB,OAAhB,CACvF,GADuF,CAAtE;AAAA,GAArB;;AAGA,OAAA,OAAA,GAAoB;AAAA,WAAc,MAAM,CAAC,QAAP,CAAgB,MAA9B;AAAA,GAApB;;AAEA,OAAA,IAAA,GAAiB;AAAA,WAAc,MAAM,CAAC,QAAP,CAAgB,IAA9B;AAAA,GAAjB;;AAEA,OAAA,SAAA,GAAsB;AAAA,WAAgB,MAAM,CAAC,QAAP,CAAgB,QAAhB,CAAyB,KAAzB,CAA+B,GAA/B,CAAhB;AAAA,GAAtB;AAtBC,C;;AAFL,OAAA,CAAA,OAAA,GAAA,OAAA;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC9eA,IAAA,SAAA,GAAA,OAAA,CAAA,qBAAA,CAAA;;AACA,IAAA,SAAA,GAAA,OAAA,CAAA,qBAAA,CAAA;;AACA,IAAA,YAAA,GAAA,OAAA,CAAA,wBAAA,CAAA;;AACA,IAAA,MAAA,GAAA,OAAA,CAAA,6BAAA,CAAA;;AACA,IAAA,aAAA,GAAA,OAAA,CAAA,yBAAA,CAAA;;IAEqB,G;;;AACjB,iBAAA;AAAA;AACC;;;;8BAEM;AACH,UAAI;AACA,aAAK,YAAL;AACH,OAFD,CAEE,OAAO,KAAP,EAAc,CACf;AACJ;;;mCAEW;AACR,UAAI,SAAS,GAAG,QAAQ,CAAC,gBAAT,CAA0B,OAA1B,CAAhB;AACA,SAAG,KAAH,CACK,IADL,CACU,SADV,EAEK,OAFL,CAEa,UAAC,OAAD,EAAmB,KAAnB,EAAkC,KAAlC,EAA0D;AAC/D,QAAA,OAAO,CAAC,gBAAR,CACI,OADJ,EAEI,YAAK;AACD,cAAM,OAAO,GAAG,IAAI,SAAA,CAAA,OAAJ,CAAY,OAAZ,CAAhB;AACA,cAAM,OAAO,GAAG,IAAI,SAAA,CAAA,OAAJ,EAAhB;AACA,cAAI,MAAM,GAAG,OAAO,CAAC,WAAR,CAAoB,QAApB,CAAb;AACA,cAAM,OAAO,aAAM,OAAO,CAAC,OAAR,EAAN,gCAA6C,MAA7C,CAAb;AACA,cAAI,YAAA,CAAA,OAAJ,CAAe,YAAf,EAA6B,IAA7B,CAAkC,OAAlC;AACA,cAAI,aAAA,CAAA,OAAJ,CAAgB,OAAhB,EACK,IADL,GAEK,IAFL,CAEU,UAAC,IAAD,EAAS;AACX,gBAAM,KAAK,GAAG,IAAI,MAAM,CAAC,KAAX,CAAiB;AAC3B,cAAA,MAAM,EAAE,IADmB;AAE3B,cAAA,YAAY,EAAE,KAFa;AAG3B,cAAA,YAAY,EAAE,CAAC,SAAD,EAAY,QAAZ,EAAsB,QAAtB,CAHa;AAI3B,cAAA,UAAU,EAAE,OAJe;AAK3B,cAAA,QAAQ,EAAE,CAAC,gBAAD,EAAmB,gBAAnB,CALiB;AAM3B,cAAA,WAAW,EAAE;AAAA,uBAAM,IAAN;AAAA;AANc,aAAjB,CAAd;AAQA,YAAA,KAAK,CAAC,UAAN,CAAiB,IAAjB;AACA,YAAA,KAAK,CAAC,IAAN;AACH,WAbL,EAcK,KAdL,CAcW,UAAC,GAAD,EAAQ;AACX,YAAA,OAAO,CAAC,KAAR,CAAc,2BAAd,EAA2C,GAAG,CAAC,UAA/C;AACH,WAhBL;AAkBH,SA1BL,EA2BI,KA3BJ;AA6BH,OAhCL;AAiCH;;;;;;AA9CL,OAAA,CAAA,OAAA,GAAA,GAAA;;AAiDA,QAAQ,CAAC,kBAAT,GAA8B,YAAK;AAC/B,MAAI,QAAQ,CAAC,UAAT,IAAuB,aAA3B,EAA0C;AACtC,QAAI,GAAJ,GAAU,OAAV;AACH;AACJ,CAJD","file":"site.min.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","ï»¿export default class DomUtil {\n\telement: Element;\n\tconstructor(element: Element) {\n\t\tthis.element = element;\n\t}\n\n\tgetDataAttr(attr: string, defaultvalue: string = undefined): any {\n\t\tif (!this.element) return null;\n\t\tconst value = this.element.getAttribute(`data-${attr}`);\n\n\t\treturn value !== undefined ? value : defaultvalue;\n\t}\n\n\tsetDataAttr(attr: string, value: string): any {\n\t\tif (!this.element) return null;\n\t\treturn this.element.setAttribute(`data-${attr}`, value);\n\t}\n\n\tgetAttr(attr: string, defaultvalue: string = undefined): any {\n\t\tif (!this.element) return null;\n\t\tconst value = this.element.getAttribute(attr)\n\n\t\treturn value !== undefined ? value : defaultvalue;\n\t}\n\n\tsetAttr(attr: string, value: string): void {\n\t\tif (!this.element) return null;\n\t\tthis.element.setAttribute(attr, value);\n\t}\n\n\tremoveAttr(attr: string): void {\n\t\tif (!this.element) return null;\n\t\tthis.element.removeAttribute(attr);\n\t}\n\n\thasAttr(attr: string): boolean {\n\t\tif (!this.element) return null;\n\t\treturn this.element.hasAttribute(attr);\n\t}\n\n\tshake(): void {\n\t\tthis.appendClass(\"shake\");\n\t\tsetTimeout(() => {\n\t\t\tthis.removeClass(\"shake\");\n\t\t\t(this.element as HTMLInputElement).readOnly = false;\n\t\t}, 300);\n\t}\n\n\tremoveClass(classname) {\n\t\tthis.element.classList.remove(classname);\n\t}\n\n\tappendClass(classname) {\n\t\tthis.element.classList.add(classname);\n\t}\n}\n","\nexport default class HtmlLoader {\n    targetElement: HTMLElement;\n\n    constructor(queryString: string) {\n        this.targetElement = document.querySelector(queryString);\n    }\n\n    load(url: string, method: string = \"get\") {\n        if (!this.targetElement) {\n            throw new Error(\"missing target element\");\n        }\n\n        const xmlHttpRequest = new XMLHttpRequest();\n\n        xmlHttpRequest.onreadystatechange = () => {\n            if (xmlHttpRequest.readyState == 4 && xmlHttpRequest.status == 200) {\n                this.targetElement.innerHTML = xmlHttpRequest.responseText;\n            }\n        };\n\n        xmlHttpRequest.open(method, url, true);\n        xmlHttpRequest.send();\n    }\n}","\nexport default class MakeRequest {\n    method: string;\n    url: string;\n    constructor(url: string, method: string = \"get\") {\n        this.method = method;\n        this.url = url;\n    }\n\n    send() {\n        return new Promise((resolve, reject) => {\n            const xmlHttpRequest = new XMLHttpRequest();\n            xmlHttpRequest.open(this.method, this.url);\n            xmlHttpRequest.onload = () => {\n                if (xmlHttpRequest.status >= 200 && xmlHttpRequest.status < 300) {\n                    resolve(xmlHttpRequest.response);\n                } else {\n                    reject({\n                        status: xmlHttpRequest.status,\n                        statusText: xmlHttpRequest.statusText\n                    });\n                }\n            };\n            xmlHttpRequest.onerror = () => {\n                reject({\n                    status: xmlHttpRequest.status,\n                    statusText: xmlHttpRequest.statusText\n                });\n            };\n            xmlHttpRequest.send();\n        });\n    }\n}\n","export default class UrlUtil {\n    constructor() {\n    }\n\n    queryValue: Function = (field: string, url?: string): string => {\n        var href: string = url ? url : window.location.href;\n        var reg: RegExp = new RegExp('[?&]' + field + '=([^&#]*)', 'i');\n        var string: string[] = reg.exec(href);\n        return string ? string[1].toLowerCase() : null;\n    };\n\n    currentURL: Function = (): string => window.location.href;\n\n    getURLParameters: Function = (url: string): any =>\n        (url.match(/([^?=&]+)(=([^&]*))/g) || []).reduce((a, v) =>\n            ((a[v.slice(0, v.indexOf(\"=\"))] = v.slice(v.indexOf(\"=\") + 1)), a), {});\n\n    redirect: Function = (url, asLink = true): void => asLink ? (window.location.href = url) : window.location.replace(\n        url);\n\n    baseUrl: Function = (): string => window.location.origin;\n\n    host: Function = (): string => window.location.host;\n\n    pathArray: Function = (): string[] => window.location.pathname.split('/');\n}\n","/*!\n* tingle.js\n* @author  robin_parisi\n* @version 0.14.0\n* @url\n*/\n\n/*global define,module*/\n(function(root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(factory)\n    } else if (typeof exports === 'object') {\n        module.exports = factory()\n    } else {\n        root.tingle = factory()\n    }\n}(this, function() {\n\n    /* ----------------------------------------------------------- */\n    /* == modal */\n    /* ----------------------------------------------------------- */\n\n    var transitionEvent = whichTransitionEvent()\n    var isBusy = false\n\n    function Modal(options) {\n        var defaults = {\n            onClose: null,\n            onOpen: null,\n            beforeOpen: null,\n            beforeClose: null,\n            stickyFooter: false,\n            footer: false,\n            cssClass: [],\n            closeLabel: 'Close',\n            closeMethods: ['overlay', 'button', 'escape']\n        }\n\n        // extends config\n        this.opts = extend({}, defaults, options)\n        \n        // init modal\n        this.init()\n    }\n\n    Modal.prototype.init = function() {\n        if (this.modal) {\n            return\n        }\n\n        _build.call(this)\n        _bindEvents.call(this)\n\n        // insert modal in dom\n        document.body.insertBefore(this.modal, document.body.firstChild)\n\n        if (this.opts.footer) {\n            this.addFooter()\n        }\n\n        return this\n    }\n\n    Modal.prototype._busy = function(state) {\n        isBusy = state\n    }\n\n    Modal.prototype._isBusy = function() {\n        return isBusy\n    }\n\n    Modal.prototype.destroy = function() {\n        if (this.modal === null) {\n            return\n        }\n\n        // restore scrolling\n        if (this.isOpen()) {\n            this.close(true)\n        }\n\n        // unbind all events\n        _unbindEvents.call(this)\n\n        // remove modal from dom\n        this.modal.parentNode.removeChild(this.modal)\n\n        this.modal = null\n    }\n\n    Modal.prototype.isOpen = function() {\n        return !!this.modal.classList.contains('tingle-modal--visible')\n    }\n\n    Modal.prototype.open = function() {\n        if(this._isBusy()) return\n        this._busy(true)\n\n        var self = this\n\n        // before open callback\n        if (typeof self.opts.beforeOpen === 'function') {\n            self.opts.beforeOpen()\n        }\n\n        if (this.modal.style.removeProperty) {\n            this.modal.style.removeProperty('display')\n        } else {\n            this.modal.style.removeAttribute('display')\n        }\n\n        // prevent double scroll\n        this._scrollPosition = window.pageYOffset\n        document.body.classList.add('tingle-enabled')\n        document.body.style.top = -this._scrollPosition + 'px'\n\n        // sticky footer\n        this.setStickyFooter(this.opts.stickyFooter)\n\n        // show modal\n        this.modal.classList.add('tingle-modal--visible')\n\n        if (transitionEvent) {\n            this.modal.addEventListener(transitionEvent, function handler() {\n                if (typeof self.opts.onOpen === 'function') {\n                    self.opts.onOpen.call(self)\n                }\n\n                // detach event after transition end (so it doesn't fire multiple onOpen)\n                self.modal.removeEventListener(transitionEvent, handler, false)\n                self._busy(false)\n            }, false)\n        } else {\n            if (typeof self.opts.onOpen === 'function') {\n                self.opts.onOpen.call(self)\n            }\n            self._busy(false)\n        }\n\n        // check if modal is bigger than screen height\n        this.checkOverflow()\n\n        return this\n    }\n\n    Modal.prototype.close = function(force) {\n        if(this._isBusy()) return\n        this._busy(true)\n        force = force || false\n\n        //  before close\n        if (typeof this.opts.beforeClose === 'function') {\n            var close = this.opts.beforeClose.call(this)\n            if (!close) return\n        }\n\n        document.body.classList.remove('tingle-enabled')\n        window.scrollTo(0, this._scrollPosition)\n        document.body.style.top = null\n\n        this.modal.classList.remove('tingle-modal--visible')\n\n        //Using similar setup as onOpen\n        //Reference to the Modal that's created\n        var self = this\n\n        if (force) {\n            self.modal.style.display = 'none'\n            if (typeof self.opts.onClose === 'function') {\n                self.opts.onClose.call(this)\n            }\n            self._busy(false)\n        } else if (transitionEvent) {\n            //Track when transition is happening then run onClose on complete\n            this.modal.addEventListener(transitionEvent, function handler() {\n                // detach event after transition end (so it doesn't fire multiple onClose)\n                self.modal.removeEventListener(transitionEvent, handler, false)\n\n                self.modal.style.display = 'none'\n\n                // on close callback\n                if (typeof self.opts.onClose === 'function') {\n                    self.opts.onClose.call(this)\n                }\n\n                self._busy(false)\n\n            }, false)\n        } else {\n            self.modal.style.display = 'none'\n            // on close callback\n            if (typeof self.opts.onClose === 'function') {\n                self.opts.onClose.call(this)\n            }\n            self._busy(false)\n        }\n    }\n\n    Modal.prototype.setContent = function(content) {\n        // check type of content : String or Node\n        if (typeof content === 'string') {\n            this.modalBoxContent.innerHTML = content\n        } else {\n            this.modalBoxContent.innerHTML = ''\n            this.modalBoxContent.appendChild(content)\n        }\n\n        if (this.isOpen()) {\n            // check if modal is bigger than screen height\n            this.checkOverflow()\n        }\n        \n        return this\n    }\n\n    Modal.prototype.getContent = function() {\n        return this.modalBoxContent\n    }\n\n    Modal.prototype.addFooter = function() {\n        // add footer to modal\n        _buildFooter.call(this)\n\n        return this\n    }\n\n    Modal.prototype.setFooterContent = function(content) {\n        // set footer content\n        this.modalBoxFooter.innerHTML = content\n\n        return this\n    }\n\n    Modal.prototype.getFooterContent = function() {\n        return this.modalBoxFooter\n    }\n\n    Modal.prototype.setStickyFooter = function(isSticky) {\n        // if the modal is smaller than the viewport height, we don't need sticky\n        if (!this.isOverflow()) {\n            isSticky = false\n        }\n\n        if (isSticky) {\n            if (this.modalBox.contains(this.modalBoxFooter)) {\n                this.modalBox.removeChild(this.modalBoxFooter)\n                this.modal.appendChild(this.modalBoxFooter)\n                this.modalBoxFooter.classList.add('tingle-modal-box__footer--sticky')\n                _recalculateFooterPosition.call(this)\n                this.modalBoxContent.style['padding-bottom'] = this.modalBoxFooter.clientHeight + 20 + 'px'\n            }\n        } else if (this.modalBoxFooter) {\n            if (!this.modalBox.contains(this.modalBoxFooter)) {\n                this.modal.removeChild(this.modalBoxFooter)\n                this.modalBox.appendChild(this.modalBoxFooter)\n                this.modalBoxFooter.style.width = 'auto'\n                this.modalBoxFooter.style.left = ''\n                this.modalBoxContent.style['padding-bottom'] = ''\n                this.modalBoxFooter.classList.remove('tingle-modal-box__footer--sticky')\n            }\n        }\n\n        return this\n    }\n\n\n    Modal.prototype.addFooterBtn = function(label, cssClass, callback) {\n        var btn = document.createElement('button')\n                \n        // set label\n        btn.innerHTML = label\n\n        // bind callback\n        btn.addEventListener('click', callback)\n\n        if (typeof cssClass === 'string' && cssClass.length) {\n            // add classes to btn\n            cssClass.split(' ').forEach(function(item) {\n                btn.classList.add(item)\n            })\n        }\n\n        this.modalBoxFooter.appendChild(btn)\n\n        return btn\n    }\n\n    Modal.prototype.resize = function() {\n        // eslint-disable-next-line no-console\n        console.warn('Resize is deprecated and will be removed in version 1.0')\n    }\n\n    Modal.prototype.isOverflow = function() {\n        var viewportHeight = window.innerHeight\n        var modalHeight = this.modalBox.clientHeight\n\n        return modalHeight >= viewportHeight\n    }\n\n    Modal.prototype.checkOverflow = function() {\n        // only if the modal is currently shown\n        if (this.modal.classList.contains('tingle-modal--visible')) {\n            if (this.isOverflow()) {\n                this.modal.classList.add('tingle-modal--overflow')\n            } else {\n                this.modal.classList.remove('tingle-modal--overflow')\n            }\n\n            // TODO: remove offset\n            //_offset.call(this);\n            if (!this.isOverflow() && this.opts.stickyFooter) {\n                this.setStickyFooter(false)\n            } else if (this.isOverflow() && this.opts.stickyFooter) {\n                _recalculateFooterPosition.call(this)\n                this.setStickyFooter(true)\n            }\n        }\n    }\n\n\n    /* ----------------------------------------------------------- */\n    /* == private methods */\n    /* ----------------------------------------------------------- */\n\n    function _recalculateFooterPosition() {\n        if (!this.modalBoxFooter) {\n            return\n        }\n        this.modalBoxFooter.style.width = this.modalBox.clientWidth + 'px'\n        this.modalBoxFooter.style.left = this.modalBox.offsetLeft + 'px'\n    }\n\n    function _build() {\n\n        // wrapper\n        this.modal = document.createElement('div')\n        this.modal.classList.add('tingle-modal')\n\n        // remove cusor if no overlay close method\n        if (this.opts.closeMethods.length === 0 || this.opts.closeMethods.indexOf('overlay') === -1) {\n            this.modal.classList.add('tingle-modal--noOverlayClose')\n        }\n\n        this.modal.style.display = 'none'\n\n        // custom class\n        this.opts.cssClass.forEach(function(item) {\n            if (typeof item === 'string') {\n                this.modal.classList.add(item)\n            }\n        }, this)\n\n        // close btn\n        if (this.opts.closeMethods.indexOf('button') !== -1) {\n            this.modalCloseBtn = document.createElement('button')\n            this.modalCloseBtn.type = 'button'\n            this.modalCloseBtn.classList.add('tingle-modal__close')\n\n            this.modalCloseBtnIcon = document.createElement('span')\n            this.modalCloseBtnIcon.classList.add('tingle-modal__closeIcon')\n            this.modalCloseBtnIcon.innerHTML = 'Ã'\n\n            this.modalCloseBtnLabel = document.createElement('span')\n            this.modalCloseBtnLabel.classList.add('tingle-modal__closeLabel')\n            this.modalCloseBtnLabel.innerHTML = this.opts.closeLabel\n\n            this.modalCloseBtn.appendChild(this.modalCloseBtnIcon)\n            this.modalCloseBtn.appendChild(this.modalCloseBtnLabel)\n        }\n\n        // modal\n        this.modalBox = document.createElement('div')\n        this.modalBox.classList.add('tingle-modal-box')\n\n        // modal box content\n        this.modalBoxContent = document.createElement('div')\n        this.modalBoxContent.classList.add('tingle-modal-box__content')\n\n        this.modalBox.appendChild(this.modalBoxContent)\n\n        if (this.opts.closeMethods.indexOf('button') !== -1) {\n            this.modal.appendChild(this.modalCloseBtn)\n        }\n\n        this.modal.appendChild(this.modalBox)\n\n    }\n\n    function _buildFooter() {\n        this.modalBoxFooter = document.createElement('div')\n        this.modalBoxFooter.classList.add('tingle-modal-box__footer')\n        this.modalBox.appendChild(this.modalBoxFooter)\n    }\n\n    function _bindEvents() {\n\n        this._events = {\n            clickCloseBtn: this.close.bind(this),\n            clickOverlay: _handleClickOutside.bind(this),\n            resize: this.checkOverflow.bind(this),\n            keyboardNav: _handleKeyboardNav.bind(this)\n        }\n\n        if (this.opts.closeMethods.indexOf('button') !== -1) {\n            this.modalCloseBtn.addEventListener('click', this._events.clickCloseBtn)\n        }\n\n        this.modal.addEventListener('mousedown', this._events.clickOverlay)\n        window.addEventListener('resize', this._events.resize)\n        document.addEventListener('keydown', this._events.keyboardNav)\n    }\n\n    function _handleKeyboardNav(event) {\n        // escape key\n        if (this.opts.closeMethods.indexOf('escape') !== -1 && event.which === 27 && this.isOpen()) {\n            this.close()\n        }\n    }\n\n    function _handleClickOutside(event) {\n        // if click is outside the modal\n        if (this.opts.closeMethods.indexOf('overlay') !== -1 && !_findAncestor(event.target, 'tingle-modal') &&\n        event.clientX < this.modal.clientWidth) {\n            this.close()\n        }\n    }\n\n    function _findAncestor(el, cls) {\n        while ((el = el.parentElement) && !el.classList.contains(cls));\n        return el\n    }\n\n    function _unbindEvents() {\n        if (this.opts.closeMethods.indexOf('button') !== -1) {\n            this.modalCloseBtn.removeEventListener('click', this._events.clickCloseBtn)\n        }\n        this.modal.removeEventListener('mousedown', this._events.clickOverlay)\n        window.removeEventListener('resize', this._events.resize)\n        document.removeEventListener('keydown', this._events.keyboardNav)\n    }\n\n    /* ----------------------------------------------------------- */\n    /* == confirm */\n    /* ----------------------------------------------------------- */\n\n    // coming soon\n\n    /* ----------------------------------------------------------- */\n    /* == alert */\n    /* ----------------------------------------------------------- */\n\n    // coming soon\n\n    /* ----------------------------------------------------------- */\n    /* == helpers */\n    /* ----------------------------------------------------------- */\n\n    function extend() {\n        for (var i = 1; i < arguments.length; i++) {\n            for (var key in arguments[i]) {\n                if (arguments[i].hasOwnProperty(key)) {\n                    arguments[0][key] = arguments[i][key]\n                }\n            }\n        }\n        return arguments[0]\n    }\n\n    function whichTransitionEvent() {\n        var t\n        var el = document.createElement('tingle-test-transition')\n        var transitions = {\n            'transition': 'transitionend',\n            'OTransition': 'oTransitionEnd',\n            'MozTransition': 'transitionend',\n            'WebkitTransition': 'webkitTransitionEnd'\n        }\n\n        for (t in transitions) {\n            if (el.style[t] !== undefined) {\n                return transitions[t]\n            }\n        }\n    }\n\n    /* ----------------------------------------------------------- */\n    /* == return */\n    /* ----------------------------------------------------------- */\n\n    return {\n        modal: Modal\n    }\n\n}))\n","import DomUtil from \"./Utilities/DomUtil\";\nimport UrlUtil from \"./Utilities/UrlUtil\";\nimport HtmlLoader from \"./Utilities/HtmlLoader\";\nimport * as tingle from \"./Vendor/tingle/dist/tingle\";\nimport MakeRequest from \"./Utilities/MakeRequest\";\n\nexport default class App {\n    constructor() {\n    }\n\n    execute() {\n        try {\n            this.setListeners()\n        } catch (error) {\n        }\n    }\n\n    setListeners() {\n        var usersRows = document.querySelectorAll('.user');\n        [].slice\n            .call(usersRows)\n            .forEach((element: Element, index: number, array: HTMLElement[]) => {\n                element.addEventListener(\n                    \"click\",\n                    () => {\n                        const domUtil = new DomUtil(element);\n                        const urlUtil = new UrlUtil();\n                        var userId = domUtil.getDataAttr('userid');\n                        const userUrl = `${urlUtil.baseUrl()}/api/modal/user?id=${userId}`;\n                        new HtmlLoader('#userModal').load(userUrl);\n                        new MakeRequest(userUrl)\n                            .send()\n                            .then((data) => {\n                                const modal = new tingle.modal({\n                                    footer: true,\n                                    stickyFooter: false,\n                                    closeMethods: ['overlay', 'button', 'escape'],\n                                    closeLabel: \"Close\",\n                                    cssClass: ['custom-class-1', 'custom-class-2'],\n                                    beforeClose: () => true\n                                });\n                                modal.setContent(data);\n                                modal.open();\n                            })\n                            .catch((err) => {\n                                console.error('Augh, there was an error!', err.statusText);\n                            });\n\n                    },\n                    false\n                );\n            });\n    }\n}\n\ndocument.onreadystatechange = () => {\n    if (document.readyState == \"interactive\") {\n        new App().execute();\n    }\n};\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJTY3JpcHRzL1V0aWxpdGllcy9Eb21VdGlsLnRzIiwiU2NyaXB0cy9VdGlsaXRpZXMvSHRtbExvYWRlci50cyIsIlNjcmlwdHMvVXRpbGl0aWVzL01ha2VSZXF1ZXN0LnRzIiwiU2NyaXB0cy9VdGlsaXRpZXMvVXJsVXRpbC50cyIsIlNjcmlwdHMvVmVuZG9yL3RpbmdsZS9kaXN0L3RpbmdsZS5qcyIsIlNjcmlwdHMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7OztJQ0FzQixPOzs7QUFFckIsbUJBQVksT0FBWixFQUE0QjtBQUFBOztBQUMzQixTQUFLLE9BQUwsR0FBZSxPQUFmO0FBQ0E7Ozs7Z0NBRVcsSSxFQUE4QztBQUFBLFVBQWhDLFlBQWdDLHVFQUFULFNBQVM7QUFDekQsVUFBSSxDQUFDLEtBQUssT0FBVixFQUFtQixPQUFPLElBQVA7QUFDbkIsVUFBTSxLQUFLLEdBQUcsS0FBSyxPQUFMLENBQWEsWUFBYixnQkFBa0MsSUFBbEMsRUFBZDtBQUVBLGFBQU8sS0FBSyxLQUFLLFNBQVYsR0FBc0IsS0FBdEIsR0FBOEIsWUFBckM7QUFDQTs7O2dDQUVXLEksRUFBYyxLLEVBQWE7QUFDdEMsVUFBSSxDQUFDLEtBQUssT0FBVixFQUFtQixPQUFPLElBQVA7QUFDbkIsYUFBTyxLQUFLLE9BQUwsQ0FBYSxZQUFiLGdCQUFrQyxJQUFsQyxHQUEwQyxLQUExQyxDQUFQO0FBQ0E7Ozs0QkFFTyxJLEVBQThDO0FBQUEsVUFBaEMsWUFBZ0MsdUVBQVQsU0FBUztBQUNyRCxVQUFJLENBQUMsS0FBSyxPQUFWLEVBQW1CLE9BQU8sSUFBUDtBQUNuQixVQUFNLEtBQUssR0FBRyxLQUFLLE9BQUwsQ0FBYSxZQUFiLENBQTBCLElBQTFCLENBQWQ7QUFFQSxhQUFPLEtBQUssS0FBSyxTQUFWLEdBQXNCLEtBQXRCLEdBQThCLFlBQXJDO0FBQ0E7Ozs0QkFFTyxJLEVBQWMsSyxFQUFhO0FBQ2xDLFVBQUksQ0FBQyxLQUFLLE9BQVYsRUFBbUIsT0FBTyxJQUFQO0FBQ25CLFdBQUssT0FBTCxDQUFhLFlBQWIsQ0FBMEIsSUFBMUIsRUFBZ0MsS0FBaEM7QUFDQTs7OytCQUVVLEksRUFBWTtBQUN0QixVQUFJLENBQUMsS0FBSyxPQUFWLEVBQW1CLE9BQU8sSUFBUDtBQUNuQixXQUFLLE9BQUwsQ0FBYSxlQUFiLENBQTZCLElBQTdCO0FBQ0E7Ozs0QkFFTyxJLEVBQVk7QUFDbkIsVUFBSSxDQUFDLEtBQUssT0FBVixFQUFtQixPQUFPLElBQVA7QUFDbkIsYUFBTyxLQUFLLE9BQUwsQ0FBYSxZQUFiLENBQTBCLElBQTFCLENBQVA7QUFDQTs7OzRCQUVJO0FBQUE7O0FBQ0osV0FBSyxXQUFMLENBQWlCLE9BQWpCO0FBQ0EsTUFBQSxVQUFVLENBQUMsWUFBSztBQUNmLFFBQUEsS0FBSSxDQUFDLFdBQUwsQ0FBaUIsT0FBakI7O0FBQ0MsUUFBQSxLQUFJLENBQUMsT0FBTCxDQUFrQyxRQUFsQyxHQUE2QyxLQUE3QztBQUNELE9BSFMsRUFHUCxHQUhPLENBQVY7QUFJQTs7O2dDQUVXLFMsRUFBUztBQUNwQixXQUFLLE9BQUwsQ0FBYSxTQUFiLENBQXVCLE1BQXZCLENBQThCLFNBQTlCO0FBQ0E7OztnQ0FFVyxTLEVBQVM7QUFDcEIsV0FBSyxPQUFMLENBQWEsU0FBYixDQUF1QixHQUF2QixDQUEyQixTQUEzQjtBQUNBOzs7Ozs7QUF0REQsT0FBQSxDQUFBLE9BQUEsR0FBQSxPQUFBOzs7Ozs7Ozs7Ozs7Ozs7SUNDb0IsVTs7O0FBR2pCLHNCQUFZLFdBQVosRUFBK0I7QUFBQTs7QUFDM0IsU0FBSyxhQUFMLEdBQXFCLFFBQVEsQ0FBQyxhQUFULENBQXVCLFdBQXZCLENBQXJCO0FBQ0g7Ozs7eUJBRUksRyxFQUFtQztBQUFBOztBQUFBLFVBQXRCLE1BQXNCLHVFQUFMLEtBQUs7O0FBQ3BDLFVBQUksQ0FBQyxLQUFLLGFBQVYsRUFBeUI7QUFDckIsY0FBTSxJQUFJLEtBQUosQ0FBVSx3QkFBVixDQUFOO0FBQ0g7O0FBRUQsVUFBTSxjQUFjLEdBQUcsSUFBSSxjQUFKLEVBQXZCOztBQUVBLE1BQUEsY0FBYyxDQUFDLGtCQUFmLEdBQW9DLFlBQUs7QUFDckMsWUFBSSxjQUFjLENBQUMsVUFBZixJQUE2QixDQUE3QixJQUFrQyxjQUFjLENBQUMsTUFBZixJQUF5QixHQUEvRCxFQUFvRTtBQUNoRSxVQUFBLEtBQUksQ0FBQyxhQUFMLENBQW1CLFNBQW5CLEdBQStCLGNBQWMsQ0FBQyxZQUE5QztBQUNIO0FBQ0osT0FKRDs7QUFNQSxNQUFBLGNBQWMsQ0FBQyxJQUFmLENBQW9CLE1BQXBCLEVBQTRCLEdBQTVCLEVBQWlDLElBQWpDO0FBQ0EsTUFBQSxjQUFjLENBQUMsSUFBZjtBQUNIOzs7Ozs7QUF0QkwsT0FBQSxDQUFBLE9BQUEsR0FBQSxVQUFBOzs7Ozs7Ozs7Ozs7Ozs7SUNBcUIsVzs7O0FBR2pCLHVCQUFZLEdBQVosRUFBK0M7QUFBQSxRQUF0QixNQUFzQix1RUFBTCxLQUFLOztBQUFBOztBQUMzQyxTQUFLLE1BQUwsR0FBYyxNQUFkO0FBQ0EsU0FBSyxHQUFMLEdBQVcsR0FBWDtBQUNIOzs7OzJCQUVHO0FBQUE7O0FBQ0EsYUFBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQW9CO0FBQ25DLFlBQU0sY0FBYyxHQUFHLElBQUksY0FBSixFQUF2QjtBQUNBLFFBQUEsY0FBYyxDQUFDLElBQWYsQ0FBb0IsS0FBSSxDQUFDLE1BQXpCLEVBQWlDLEtBQUksQ0FBQyxHQUF0Qzs7QUFDQSxRQUFBLGNBQWMsQ0FBQyxNQUFmLEdBQXdCLFlBQUs7QUFDekIsY0FBSSxjQUFjLENBQUMsTUFBZixJQUF5QixHQUF6QixJQUFnQyxjQUFjLENBQUMsTUFBZixHQUF3QixHQUE1RCxFQUFpRTtBQUM3RCxZQUFBLE9BQU8sQ0FBQyxjQUFjLENBQUMsUUFBaEIsQ0FBUDtBQUNILFdBRkQsTUFFTztBQUNILFlBQUEsTUFBTSxDQUFDO0FBQ0gsY0FBQSxNQUFNLEVBQUUsY0FBYyxDQUFDLE1BRHBCO0FBRUgsY0FBQSxVQUFVLEVBQUUsY0FBYyxDQUFDO0FBRnhCLGFBQUQsQ0FBTjtBQUlIO0FBQ0osU0FURDs7QUFVQSxRQUFBLGNBQWMsQ0FBQyxPQUFmLEdBQXlCLFlBQUs7QUFDMUIsVUFBQSxNQUFNLENBQUM7QUFDSCxZQUFBLE1BQU0sRUFBRSxjQUFjLENBQUMsTUFEcEI7QUFFSCxZQUFBLFVBQVUsRUFBRSxjQUFjLENBQUM7QUFGeEIsV0FBRCxDQUFOO0FBSUgsU0FMRDs7QUFNQSxRQUFBLGNBQWMsQ0FBQyxJQUFmO0FBQ0gsT0FwQk0sQ0FBUDtBQXFCSDs7Ozs7O0FBOUJMLE9BQUEsQ0FBQSxPQUFBLEdBQUEsV0FBQTs7Ozs7Ozs7Ozs7SUNEcUIsTyxHQUNqQixtQkFBQTtBQUFBOztBQUdBLE9BQUEsVUFBQSxHQUF1QixVQUFDLEtBQUQsRUFBZ0IsR0FBaEIsRUFBd0M7QUFDM0QsUUFBSSxJQUFJLEdBQVcsR0FBRyxHQUFHLEdBQUgsR0FBUyxNQUFNLENBQUMsUUFBUCxDQUFnQixJQUEvQztBQUNBLFFBQUksR0FBRyxHQUFXLElBQUksTUFBSixDQUFXLFNBQVMsS0FBVCxHQUFpQixXQUE1QixFQUF5QyxHQUF6QyxDQUFsQjtBQUNBLFFBQUksTUFBTSxHQUFhLEdBQUcsQ0FBQyxJQUFKLENBQVMsSUFBVCxDQUF2QjtBQUNBLFdBQU8sTUFBTSxHQUFHLE1BQU0sQ0FBQyxDQUFELENBQU4sQ0FBVSxXQUFWLEVBQUgsR0FBNkIsSUFBMUM7QUFDSCxHQUxEOztBQU9BLE9BQUEsVUFBQSxHQUF1QjtBQUFBLFdBQWMsTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsSUFBOUI7QUFBQSxHQUF2Qjs7QUFFQSxPQUFBLGdCQUFBLEdBQTZCLFVBQUMsR0FBRDtBQUFBLFdBQ3pCLENBQUMsR0FBRyxDQUFDLEtBQUosQ0FBVSxzQkFBVixLQUFxQyxFQUF0QyxFQUEwQyxNQUExQyxDQUFpRCxVQUFDLENBQUQsRUFBSSxDQUFKO0FBQUEsYUFDM0MsQ0FBQyxDQUFDLENBQUMsQ0FBQyxLQUFGLENBQVEsQ0FBUixFQUFXLENBQUMsQ0FBQyxPQUFGLENBQVUsR0FBVixDQUFYLENBQUQsQ0FBRCxHQUFnQyxDQUFDLENBQUMsS0FBRixDQUFRLENBQUMsQ0FBQyxPQUFGLENBQVUsR0FBVixJQUFpQixDQUF6QixDQUFqQyxFQUErRCxDQURuQjtBQUFBLEtBQWpELEVBQ3dFLEVBRHhFLENBRHlCO0FBQUEsR0FBN0I7O0FBSUEsT0FBQSxRQUFBLEdBQXFCLFVBQUMsR0FBRDtBQUFBLFFBQU0sTUFBTix1RUFBZSxJQUFmO0FBQUEsV0FBOEIsTUFBTSxHQUFJLE1BQU0sQ0FBQyxRQUFQLENBQWdCLElBQWhCLEdBQXVCLEdBQTNCLEdBQWtDLE1BQU0sQ0FBQyxRQUFQLENBQWdCLE9BQWhCLENBQ3ZGLEdBRHVGLENBQXRFO0FBQUEsR0FBckI7O0FBR0EsT0FBQSxPQUFBLEdBQW9CO0FBQUEsV0FBYyxNQUFNLENBQUMsUUFBUCxDQUFnQixNQUE5QjtBQUFBLEdBQXBCOztBQUVBLE9BQUEsSUFBQSxHQUFpQjtBQUFBLFdBQWMsTUFBTSxDQUFDLFFBQVAsQ0FBZ0IsSUFBOUI7QUFBQSxHQUFqQjs7QUFFQSxPQUFBLFNBQUEsR0FBc0I7QUFBQSxXQUFnQixNQUFNLENBQUMsUUFBUCxDQUFnQixRQUFoQixDQUF5QixLQUF6QixDQUErQixHQUEvQixDQUFoQjtBQUFBLEdBQXRCO0FBdEJDLEM7O0FBRkwsT0FBQSxDQUFBLE9BQUEsR0FBQSxPQUFBOzs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFBLENBQUEsT0FBQSxHQUFBLEdBQUE7O0FBaURBLFFBQVEsQ0FBQyxrQkFBVCxHQUE4QixZQUFLO0FBQy9CLE1BQUksUUFBUSxDQUFDLFVBQVQsSUFBdUIsYUFBM0IsRUFBMEM7QUFDdEMsUUFBSSxHQUFKLEdBQVUsT0FBVjtBQUNIO0FBQ0osQ0FKRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIu+7v2V4cG9ydCBkZWZhdWx0IGNsYXNzIERvbVV0aWwge1xuXHRlbGVtZW50OiBFbGVtZW50O1xuXHRjb25zdHJ1Y3RvcihlbGVtZW50OiBFbGVtZW50KSB7XG5cdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblx0fVxuXG5cdGdldERhdGFBdHRyKGF0dHI6IHN0cmluZywgZGVmYXVsdHZhbHVlOiBzdHJpbmcgPSB1bmRlZmluZWQpOiBhbnkge1xuXHRcdGlmICghdGhpcy5lbGVtZW50KSByZXR1cm4gbnVsbDtcblx0XHRjb25zdCB2YWx1ZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoYGRhdGEtJHthdHRyfWApO1xuXG5cdFx0cmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IGRlZmF1bHR2YWx1ZTtcblx0fVxuXG5cdHNldERhdGFBdHRyKGF0dHI6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IGFueSB7XG5cdFx0aWYgKCF0aGlzLmVsZW1lbnQpIHJldHVybiBudWxsO1xuXHRcdHJldHVybiB0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKGBkYXRhLSR7YXR0cn1gLCB2YWx1ZSk7XG5cdH1cblxuXHRnZXRBdHRyKGF0dHI6IHN0cmluZywgZGVmYXVsdHZhbHVlOiBzdHJpbmcgPSB1bmRlZmluZWQpOiBhbnkge1xuXHRcdGlmICghdGhpcy5lbGVtZW50KSByZXR1cm4gbnVsbDtcblx0XHRjb25zdCB2YWx1ZSA9IHRoaXMuZWxlbWVudC5nZXRBdHRyaWJ1dGUoYXR0cilcblxuXHRcdHJldHVybiB2YWx1ZSAhPT0gdW5kZWZpbmVkID8gdmFsdWUgOiBkZWZhdWx0dmFsdWU7XG5cdH1cblxuXHRzZXRBdHRyKGF0dHI6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGlmICghdGhpcy5lbGVtZW50KSByZXR1cm4gbnVsbDtcblx0XHR0aGlzLmVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIHZhbHVlKTtcblx0fVxuXG5cdHJlbW92ZUF0dHIoYXR0cjogc3RyaW5nKTogdm9pZCB7XG5cdFx0aWYgKCF0aGlzLmVsZW1lbnQpIHJldHVybiBudWxsO1xuXHRcdHRoaXMuZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoYXR0cik7XG5cdH1cblxuXHRoYXNBdHRyKGF0dHI6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdGlmICghdGhpcy5lbGVtZW50KSByZXR1cm4gbnVsbDtcblx0XHRyZXR1cm4gdGhpcy5lbGVtZW50Lmhhc0F0dHJpYnV0ZShhdHRyKTtcblx0fVxuXG5cdHNoYWtlKCk6IHZvaWQge1xuXHRcdHRoaXMuYXBwZW5kQ2xhc3MoXCJzaGFrZVwiKTtcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMucmVtb3ZlQ2xhc3MoXCJzaGFrZVwiKTtcblx0XHRcdCh0aGlzLmVsZW1lbnQgYXMgSFRNTElucHV0RWxlbWVudCkucmVhZE9ubHkgPSBmYWxzZTtcblx0XHR9LCAzMDApO1xuXHR9XG5cblx0cmVtb3ZlQ2xhc3MoY2xhc3NuYW1lKSB7XG5cdFx0dGhpcy5lbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NuYW1lKTtcblx0fVxuXG5cdGFwcGVuZENsYXNzKGNsYXNzbmFtZSkge1xuXHRcdHRoaXMuZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzbmFtZSk7XG5cdH1cbn1cbiIsIlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgSHRtbExvYWRlciB7XG4gICAgdGFyZ2V0RWxlbWVudDogSFRNTEVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihxdWVyeVN0cmluZzogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocXVlcnlTdHJpbmcpO1xuICAgIH1cblxuICAgIGxvYWQodXJsOiBzdHJpbmcsIG1ldGhvZDogc3RyaW5nID0gXCJnZXRcIikge1xuICAgICAgICBpZiAoIXRoaXMudGFyZ2V0RWxlbWVudCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibWlzc2luZyB0YXJnZXQgZWxlbWVudFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHhtbEh0dHBSZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgICAgeG1sSHR0cFJlcXVlc3Qub25yZWFkeXN0YXRlY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHhtbEh0dHBSZXF1ZXN0LnJlYWR5U3RhdGUgPT0gNCAmJiB4bWxIdHRwUmVxdWVzdC5zdGF0dXMgPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy50YXJnZXRFbGVtZW50LmlubmVySFRNTCA9IHhtbEh0dHBSZXF1ZXN0LnJlc3BvbnNlVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB4bWxIdHRwUmVxdWVzdC5vcGVuKG1ldGhvZCwgdXJsLCB0cnVlKTtcbiAgICAgICAgeG1sSHR0cFJlcXVlc3Quc2VuZCgpO1xuICAgIH1cbn0iLCJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1ha2VSZXF1ZXN0IHtcbiAgICBtZXRob2Q6IHN0cmluZztcbiAgICB1cmw6IHN0cmluZztcbiAgICBjb25zdHJ1Y3Rvcih1cmw6IHN0cmluZywgbWV0aG9kOiBzdHJpbmcgPSBcImdldFwiKSB7XG4gICAgICAgIHRoaXMubWV0aG9kID0gbWV0aG9kO1xuICAgICAgICB0aGlzLnVybCA9IHVybDtcbiAgICB9XG5cbiAgICBzZW5kKCkge1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeG1sSHR0cFJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIHhtbEh0dHBSZXF1ZXN0Lm9wZW4odGhpcy5tZXRob2QsIHRoaXMudXJsKTtcbiAgICAgICAgICAgIHhtbEh0dHBSZXF1ZXN0Lm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoeG1sSHR0cFJlcXVlc3Quc3RhdHVzID49IDIwMCAmJiB4bWxIdHRwUmVxdWVzdC5zdGF0dXMgPCAzMDApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh4bWxIdHRwUmVxdWVzdC5yZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogeG1sSHR0cFJlcXVlc3Quc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogeG1sSHR0cFJlcXVlc3Quc3RhdHVzVGV4dFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgeG1sSHR0cFJlcXVlc3Qub25lcnJvciA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICByZWplY3Qoe1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHhtbEh0dHBSZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogeG1sSHR0cFJlcXVlc3Quc3RhdHVzVGV4dFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHhtbEh0dHBSZXF1ZXN0LnNlbmQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXJsVXRpbCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgfVxuXG4gICAgcXVlcnlWYWx1ZTogRnVuY3Rpb24gPSAoZmllbGQ6IHN0cmluZywgdXJsPzogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICAgICAgdmFyIGhyZWY6IHN0cmluZyA9IHVybCA/IHVybCA6IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICAgICAgICB2YXIgcmVnOiBSZWdFeHAgPSBuZXcgUmVnRXhwKCdbPyZdJyArIGZpZWxkICsgJz0oW14mI10qKScsICdpJyk7XG4gICAgICAgIHZhciBzdHJpbmc6IHN0cmluZ1tdID0gcmVnLmV4ZWMoaHJlZik7XG4gICAgICAgIHJldHVybiBzdHJpbmcgPyBzdHJpbmdbMV0udG9Mb3dlckNhc2UoKSA6IG51bGw7XG4gICAgfTtcblxuICAgIGN1cnJlbnRVUkw6IEZ1bmN0aW9uID0gKCk6IHN0cmluZyA9PiB3aW5kb3cubG9jYXRpb24uaHJlZjtcblxuICAgIGdldFVSTFBhcmFtZXRlcnM6IEZ1bmN0aW9uID0gKHVybDogc3RyaW5nKTogYW55ID0+XG4gICAgICAgICh1cmwubWF0Y2goLyhbXj89Jl0rKSg9KFteJl0qKSkvZykgfHwgW10pLnJlZHVjZSgoYSwgdikgPT5cbiAgICAgICAgICAgICgoYVt2LnNsaWNlKDAsIHYuaW5kZXhPZihcIj1cIikpXSA9IHYuc2xpY2Uodi5pbmRleE9mKFwiPVwiKSArIDEpKSwgYSksIHt9KTtcblxuICAgIHJlZGlyZWN0OiBGdW5jdGlvbiA9ICh1cmwsIGFzTGluayA9IHRydWUpOiB2b2lkID0+IGFzTGluayA/ICh3aW5kb3cubG9jYXRpb24uaHJlZiA9IHVybCkgOiB3aW5kb3cubG9jYXRpb24ucmVwbGFjZShcbiAgICAgICAgdXJsKTtcblxuICAgIGJhc2VVcmw6IEZ1bmN0aW9uID0gKCk6IHN0cmluZyA9PiB3aW5kb3cubG9jYXRpb24ub3JpZ2luO1xuXG4gICAgaG9zdDogRnVuY3Rpb24gPSAoKTogc3RyaW5nID0+IHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuXG4gICAgcGF0aEFycmF5OiBGdW5jdGlvbiA9ICgpOiBzdHJpbmdbXSA9PiB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKTtcbn1cbiIsIi8qIVxuKiB0aW5nbGUuanNcbiogQGF1dGhvciAgcm9iaW5fcGFyaXNpXG4qIEB2ZXJzaW9uIDAuMTQuMFxuKiBAdXJsXG4qL1xuXG4vKmdsb2JhbCBkZWZpbmUsbW9kdWxlKi9cbihmdW5jdGlvbihyb290LCBmYWN0b3J5KSB7XG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgICBkZWZpbmUoZmFjdG9yeSlcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgICAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHJvb3QudGluZ2xlID0gZmFjdG9yeSgpXG4gICAgfVxufSh0aGlzLCBmdW5jdGlvbigpIHtcblxuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gICAgLyogPT0gbW9kYWwgKi9cbiAgICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4gICAgdmFyIHRyYW5zaXRpb25FdmVudCA9IHdoaWNoVHJhbnNpdGlvbkV2ZW50KClcbiAgICB2YXIgaXNCdXN5ID0gZmFsc2VcblxuICAgIGZ1bmN0aW9uIE1vZGFsKG9wdGlvbnMpIHtcbiAgICAgICAgdmFyIGRlZmF1bHRzID0ge1xuICAgICAgICAgICAgb25DbG9zZTogbnVsbCxcbiAgICAgICAgICAgIG9uT3BlbjogbnVsbCxcbiAgICAgICAgICAgIGJlZm9yZU9wZW46IG51bGwsXG4gICAgICAgICAgICBiZWZvcmVDbG9zZTogbnVsbCxcbiAgICAgICAgICAgIHN0aWNreUZvb3RlcjogZmFsc2UsXG4gICAgICAgICAgICBmb290ZXI6IGZhbHNlLFxuICAgICAgICAgICAgY3NzQ2xhc3M6IFtdLFxuICAgICAgICAgICAgY2xvc2VMYWJlbDogJ0Nsb3NlJyxcbiAgICAgICAgICAgIGNsb3NlTWV0aG9kczogWydvdmVybGF5JywgJ2J1dHRvbicsICdlc2NhcGUnXVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gZXh0ZW5kcyBjb25maWdcbiAgICAgICAgdGhpcy5vcHRzID0gZXh0ZW5kKHt9LCBkZWZhdWx0cywgb3B0aW9ucylcbiAgICAgICAgXG4gICAgICAgIC8vIGluaXQgbW9kYWxcbiAgICAgICAgdGhpcy5pbml0KClcbiAgICB9XG5cbiAgICBNb2RhbC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5tb2RhbCkge1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgIH1cblxuICAgICAgICBfYnVpbGQuY2FsbCh0aGlzKVxuICAgICAgICBfYmluZEV2ZW50cy5jYWxsKHRoaXMpXG5cbiAgICAgICAgLy8gaW5zZXJ0IG1vZGFsIGluIGRvbVxuICAgICAgICBkb2N1bWVudC5ib2R5Lmluc2VydEJlZm9yZSh0aGlzLm1vZGFsLCBkb2N1bWVudC5ib2R5LmZpcnN0Q2hpbGQpXG5cbiAgICAgICAgaWYgKHRoaXMub3B0cy5mb290ZXIpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkRm9vdGVyKClcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgTW9kYWwucHJvdG90eXBlLl9idXN5ID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgaXNCdXN5ID0gc3RhdGVcbiAgICB9XG5cbiAgICBNb2RhbC5wcm90b3R5cGUuX2lzQnVzeSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gaXNCdXN5XG4gICAgfVxuXG4gICAgTW9kYWwucHJvdG90eXBlLmRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKHRoaXMubW9kYWwgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgLy8gcmVzdG9yZSBzY3JvbGxpbmdcbiAgICAgICAgaWYgKHRoaXMuaXNPcGVuKCkpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UodHJ1ZSlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHVuYmluZCBhbGwgZXZlbnRzXG4gICAgICAgIF91bmJpbmRFdmVudHMuY2FsbCh0aGlzKVxuXG4gICAgICAgIC8vIHJlbW92ZSBtb2RhbCBmcm9tIGRvbVxuICAgICAgICB0aGlzLm1vZGFsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5tb2RhbClcblxuICAgICAgICB0aGlzLm1vZGFsID0gbnVsbFxuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5pc09wZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5tb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoJ3RpbmdsZS1tb2RhbC0tdmlzaWJsZScpXG4gICAgfVxuXG4gICAgTW9kYWwucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgaWYodGhpcy5faXNCdXN5KCkpIHJldHVyblxuICAgICAgICB0aGlzLl9idXN5KHRydWUpXG5cbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzXG5cbiAgICAgICAgLy8gYmVmb3JlIG9wZW4gY2FsbGJhY2tcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmLm9wdHMuYmVmb3JlT3BlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgc2VsZi5vcHRzLmJlZm9yZU9wZW4oKVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMubW9kYWwuc3R5bGUucmVtb3ZlUHJvcGVydHkpIHtcbiAgICAgICAgICAgIHRoaXMubW9kYWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoJ2Rpc3BsYXknKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5tb2RhbC5zdHlsZS5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc3BsYXknKVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJldmVudCBkb3VibGUgc2Nyb2xsXG4gICAgICAgIHRoaXMuX3Njcm9sbFBvc2l0aW9uID0gd2luZG93LnBhZ2VZT2Zmc2V0XG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZCgndGluZ2xlLWVuYWJsZWQnKVxuICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnRvcCA9IC10aGlzLl9zY3JvbGxQb3NpdGlvbiArICdweCdcblxuICAgICAgICAvLyBzdGlja3kgZm9vdGVyXG4gICAgICAgIHRoaXMuc2V0U3RpY2t5Rm9vdGVyKHRoaXMub3B0cy5zdGlja3lGb290ZXIpXG5cbiAgICAgICAgLy8gc2hvdyBtb2RhbFxuICAgICAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5hZGQoJ3RpbmdsZS1tb2RhbC0tdmlzaWJsZScpXG5cbiAgICAgICAgaWYgKHRyYW5zaXRpb25FdmVudCkge1xuICAgICAgICAgICAgdGhpcy5tb2RhbC5hZGRFdmVudExpc3RlbmVyKHRyYW5zaXRpb25FdmVudCwgZnVuY3Rpb24gaGFuZGxlcigpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYub3B0cy5vbk9wZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vcHRzLm9uT3Blbi5jYWxsKHNlbGYpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gZGV0YWNoIGV2ZW50IGFmdGVyIHRyYW5zaXRpb24gZW5kIChzbyBpdCBkb2Vzbid0IGZpcmUgbXVsdGlwbGUgb25PcGVuKVxuICAgICAgICAgICAgICAgIHNlbGYubW9kYWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0cmFuc2l0aW9uRXZlbnQsIGhhbmRsZXIsIGZhbHNlKVxuICAgICAgICAgICAgICAgIHNlbGYuX2J1c3koZmFsc2UpXG4gICAgICAgICAgICB9LCBmYWxzZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5vcHRzLm9uT3BlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIHNlbGYub3B0cy5vbk9wZW4uY2FsbChzZWxmKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5fYnVzeShmYWxzZSlcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGNoZWNrIGlmIG1vZGFsIGlzIGJpZ2dlciB0aGFuIHNjcmVlbiBoZWlnaHRcbiAgICAgICAgdGhpcy5jaGVja092ZXJmbG93KClcblxuICAgICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKGZvcmNlKSB7XG4gICAgICAgIGlmKHRoaXMuX2lzQnVzeSgpKSByZXR1cm5cbiAgICAgICAgdGhpcy5fYnVzeSh0cnVlKVxuICAgICAgICBmb3JjZSA9IGZvcmNlIHx8IGZhbHNlXG5cbiAgICAgICAgLy8gIGJlZm9yZSBjbG9zZVxuICAgICAgICBpZiAodHlwZW9mIHRoaXMub3B0cy5iZWZvcmVDbG9zZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdmFyIGNsb3NlID0gdGhpcy5vcHRzLmJlZm9yZUNsb3NlLmNhbGwodGhpcylcbiAgICAgICAgICAgIGlmICghY2xvc2UpIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKCd0aW5nbGUtZW5hYmxlZCcpXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCB0aGlzLl9zY3JvbGxQb3NpdGlvbilcbiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS50b3AgPSBudWxsXG5cbiAgICAgICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QucmVtb3ZlKCd0aW5nbGUtbW9kYWwtLXZpc2libGUnKVxuXG4gICAgICAgIC8vVXNpbmcgc2ltaWxhciBzZXR1cCBhcyBvbk9wZW5cbiAgICAgICAgLy9SZWZlcmVuY2UgdG8gdGhlIE1vZGFsIHRoYXQncyBjcmVhdGVkXG4gICAgICAgIHZhciBzZWxmID0gdGhpc1xuXG4gICAgICAgIGlmIChmb3JjZSkge1xuICAgICAgICAgICAgc2VsZi5tb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYub3B0cy5vbkNsb3NlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vcHRzLm9uQ2xvc2UuY2FsbCh0aGlzKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5fYnVzeShmYWxzZSlcbiAgICAgICAgfSBlbHNlIGlmICh0cmFuc2l0aW9uRXZlbnQpIHtcbiAgICAgICAgICAgIC8vVHJhY2sgd2hlbiB0cmFuc2l0aW9uIGlzIGhhcHBlbmluZyB0aGVuIHJ1biBvbkNsb3NlIG9uIGNvbXBsZXRlXG4gICAgICAgICAgICB0aGlzLm1vZGFsLmFkZEV2ZW50TGlzdGVuZXIodHJhbnNpdGlvbkV2ZW50LCBmdW5jdGlvbiBoYW5kbGVyKCkge1xuICAgICAgICAgICAgICAgIC8vIGRldGFjaCBldmVudCBhZnRlciB0cmFuc2l0aW9uIGVuZCAoc28gaXQgZG9lc24ndCBmaXJlIG11bHRpcGxlIG9uQ2xvc2UpXG4gICAgICAgICAgICAgICAgc2VsZi5tb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKHRyYW5zaXRpb25FdmVudCwgaGFuZGxlciwgZmFsc2UpXG5cbiAgICAgICAgICAgICAgICBzZWxmLm1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcblxuICAgICAgICAgICAgICAgIC8vIG9uIGNsb3NlIGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLm9wdHMub25DbG9zZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLm9wdHMub25DbG9zZS5jYWxsKHRoaXMpXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2VsZi5fYnVzeShmYWxzZSlcblxuICAgICAgICAgICAgfSwgZmFsc2UpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZWxmLm1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcbiAgICAgICAgICAgIC8vIG9uIGNsb3NlIGNhbGxiYWNrXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYub3B0cy5vbkNsb3NlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5vcHRzLm9uQ2xvc2UuY2FsbCh0aGlzKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2VsZi5fYnVzeShmYWxzZSlcbiAgICAgICAgfVxuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5zZXRDb250ZW50ID0gZnVuY3Rpb24oY29udGVudCkge1xuICAgICAgICAvLyBjaGVjayB0eXBlIG9mIGNvbnRlbnQgOiBTdHJpbmcgb3IgTm9kZVxuICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGFsQm94Q29udGVudC5pbm5lckhUTUwgPSBjb250ZW50XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm1vZGFsQm94Q29udGVudC5pbm5lckhUTUwgPSAnJ1xuICAgICAgICAgICAgdGhpcy5tb2RhbEJveENvbnRlbnQuYXBwZW5kQ2hpbGQoY29udGVudClcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlzT3BlbigpKSB7XG4gICAgICAgICAgICAvLyBjaGVjayBpZiBtb2RhbCBpcyBiaWdnZXIgdGhhbiBzY3JlZW4gaGVpZ2h0XG4gICAgICAgICAgICB0aGlzLmNoZWNrT3ZlcmZsb3coKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5nZXRDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZGFsQm94Q29udGVudFxuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5hZGRGb290ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gYWRkIGZvb3RlciB0byBtb2RhbFxuICAgICAgICBfYnVpbGRGb290ZXIuY2FsbCh0aGlzKVxuXG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG4gICAgTW9kYWwucHJvdG90eXBlLnNldEZvb3RlckNvbnRlbnQgPSBmdW5jdGlvbihjb250ZW50KSB7XG4gICAgICAgIC8vIHNldCBmb290ZXIgY29udGVudFxuICAgICAgICB0aGlzLm1vZGFsQm94Rm9vdGVyLmlubmVySFRNTCA9IGNvbnRlbnRcblxuICAgICAgICByZXR1cm4gdGhpc1xuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5nZXRGb290ZXJDb250ZW50ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZGFsQm94Rm9vdGVyXG4gICAgfVxuXG4gICAgTW9kYWwucHJvdG90eXBlLnNldFN0aWNreUZvb3RlciA9IGZ1bmN0aW9uKGlzU3RpY2t5KSB7XG4gICAgICAgIC8vIGlmIHRoZSBtb2RhbCBpcyBzbWFsbGVyIHRoYW4gdGhlIHZpZXdwb3J0IGhlaWdodCwgd2UgZG9uJ3QgbmVlZCBzdGlja3lcbiAgICAgICAgaWYgKCF0aGlzLmlzT3ZlcmZsb3coKSkge1xuICAgICAgICAgICAgaXNTdGlja3kgPSBmYWxzZVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGlzU3RpY2t5KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RhbEJveC5jb250YWlucyh0aGlzLm1vZGFsQm94Rm9vdGVyKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubW9kYWxCb3gucmVtb3ZlQ2hpbGQodGhpcy5tb2RhbEJveEZvb3RlcilcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLmFwcGVuZENoaWxkKHRoaXMubW9kYWxCb3hGb290ZXIpXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RhbEJveEZvb3Rlci5jbGFzc0xpc3QuYWRkKCd0aW5nbGUtbW9kYWwtYm94X19mb290ZXItLXN0aWNreScpXG4gICAgICAgICAgICAgICAgX3JlY2FsY3VsYXRlRm9vdGVyUG9zaXRpb24uY2FsbCh0aGlzKVxuICAgICAgICAgICAgICAgIHRoaXMubW9kYWxCb3hDb250ZW50LnN0eWxlWydwYWRkaW5nLWJvdHRvbSddID0gdGhpcy5tb2RhbEJveEZvb3Rlci5jbGllbnRIZWlnaHQgKyAyMCArICdweCdcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vZGFsQm94Rm9vdGVyKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kYWxCb3guY29udGFpbnModGhpcy5tb2RhbEJveEZvb3RlcikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLnJlbW92ZUNoaWxkKHRoaXMubW9kYWxCb3hGb290ZXIpXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RhbEJveC5hcHBlbmRDaGlsZCh0aGlzLm1vZGFsQm94Rm9vdGVyKVxuICAgICAgICAgICAgICAgIHRoaXMubW9kYWxCb3hGb290ZXIuc3R5bGUud2lkdGggPSAnYXV0bydcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsQm94Rm9vdGVyLnN0eWxlLmxlZnQgPSAnJ1xuICAgICAgICAgICAgICAgIHRoaXMubW9kYWxCb3hDb250ZW50LnN0eWxlWydwYWRkaW5nLWJvdHRvbSddID0gJydcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsQm94Rm9vdGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3RpbmdsZS1tb2RhbC1ib3hfX2Zvb3Rlci0tc3RpY2t5JylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzXG4gICAgfVxuXG5cbiAgICBNb2RhbC5wcm90b3R5cGUuYWRkRm9vdGVyQnRuID0gZnVuY3Rpb24obGFiZWwsIGNzc0NsYXNzLCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgLy8gc2V0IGxhYmVsXG4gICAgICAgIGJ0bi5pbm5lckhUTUwgPSBsYWJlbFxuXG4gICAgICAgIC8vIGJpbmQgY2FsbGJhY2tcbiAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2FsbGJhY2spXG5cbiAgICAgICAgaWYgKHR5cGVvZiBjc3NDbGFzcyA9PT0gJ3N0cmluZycgJiYgY3NzQ2xhc3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAvLyBhZGQgY2xhc3NlcyB0byBidG5cbiAgICAgICAgICAgIGNzc0NsYXNzLnNwbGl0KCcgJykuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICAgICAgYnRuLmNsYXNzTGlzdC5hZGQoaXRlbSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm1vZGFsQm94Rm9vdGVyLmFwcGVuZENoaWxkKGJ0bilcblxuICAgICAgICByZXR1cm4gYnRuXG4gICAgfVxuXG4gICAgTW9kYWwucHJvdG90eXBlLnJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICBjb25zb2xlLndhcm4oJ1Jlc2l6ZSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gdmVyc2lvbiAxLjAnKVxuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5pc092ZXJmbG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2aWV3cG9ydEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodFxuICAgICAgICB2YXIgbW9kYWxIZWlnaHQgPSB0aGlzLm1vZGFsQm94LmNsaWVudEhlaWdodFxuXG4gICAgICAgIHJldHVybiBtb2RhbEhlaWdodCA+PSB2aWV3cG9ydEhlaWdodFxuICAgIH1cblxuICAgIE1vZGFsLnByb3RvdHlwZS5jaGVja092ZXJmbG93ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIG9ubHkgaWYgdGhlIG1vZGFsIGlzIGN1cnJlbnRseSBzaG93blxuICAgICAgICBpZiAodGhpcy5tb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoJ3RpbmdsZS1tb2RhbC0tdmlzaWJsZScpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc092ZXJmbG93KCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5hZGQoJ3RpbmdsZS1tb2RhbC0tb3ZlcmZsb3cnKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ3RpbmdsZS1tb2RhbC0tb3ZlcmZsb3cnKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBUT0RPOiByZW1vdmUgb2Zmc2V0XG4gICAgICAgICAgICAvL19vZmZzZXQuY2FsbCh0aGlzKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5pc092ZXJmbG93KCkgJiYgdGhpcy5vcHRzLnN0aWNreUZvb3Rlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RpY2t5Rm9vdGVyKGZhbHNlKVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzT3ZlcmZsb3coKSAmJiB0aGlzLm9wdHMuc3RpY2t5Rm9vdGVyKSB7XG4gICAgICAgICAgICAgICAgX3JlY2FsY3VsYXRlRm9vdGVyUG9zaXRpb24uY2FsbCh0aGlzKVxuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RpY2t5Rm9vdGVyKHRydWUpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gICAgLyogPT0gcHJpdmF0ZSBtZXRob2RzICovXG4gICAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICAgIGZ1bmN0aW9uIF9yZWNhbGN1bGF0ZUZvb3RlclBvc2l0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMubW9kYWxCb3hGb290ZXIpIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIHRoaXMubW9kYWxCb3hGb290ZXIuc3R5bGUud2lkdGggPSB0aGlzLm1vZGFsQm94LmNsaWVudFdpZHRoICsgJ3B4J1xuICAgICAgICB0aGlzLm1vZGFsQm94Rm9vdGVyLnN0eWxlLmxlZnQgPSB0aGlzLm1vZGFsQm94Lm9mZnNldExlZnQgKyAncHgnXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2J1aWxkKCkge1xuXG4gICAgICAgIC8vIHdyYXBwZXJcbiAgICAgICAgdGhpcy5tb2RhbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LmFkZCgndGluZ2xlLW1vZGFsJylcblxuICAgICAgICAvLyByZW1vdmUgY3Vzb3IgaWYgbm8gb3ZlcmxheSBjbG9zZSBtZXRob2RcbiAgICAgICAgaWYgKHRoaXMub3B0cy5jbG9zZU1ldGhvZHMubGVuZ3RoID09PSAwIHx8IHRoaXMub3B0cy5jbG9zZU1ldGhvZHMuaW5kZXhPZignb3ZlcmxheScpID09PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QuYWRkKCd0aW5nbGUtbW9kYWwtLW5vT3ZlcmxheUNsb3NlJylcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJ1xuXG4gICAgICAgIC8vIGN1c3RvbSBjbGFzc1xuICAgICAgICB0aGlzLm9wdHMuY3NzQ2xhc3MuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QuYWRkKGl0ZW0pXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRoaXMpXG5cbiAgICAgICAgLy8gY2xvc2UgYnRuXG4gICAgICAgIGlmICh0aGlzLm9wdHMuY2xvc2VNZXRob2RzLmluZGV4T2YoJ2J1dHRvbicpICE9PSAtMSkge1xuICAgICAgICAgICAgdGhpcy5tb2RhbENsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJylcbiAgICAgICAgICAgIHRoaXMubW9kYWxDbG9zZUJ0bi50eXBlID0gJ2J1dHRvbidcbiAgICAgICAgICAgIHRoaXMubW9kYWxDbG9zZUJ0bi5jbGFzc0xpc3QuYWRkKCd0aW5nbGUtbW9kYWxfX2Nsb3NlJylcblxuICAgICAgICAgICAgdGhpcy5tb2RhbENsb3NlQnRuSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKVxuICAgICAgICAgICAgdGhpcy5tb2RhbENsb3NlQnRuSWNvbi5jbGFzc0xpc3QuYWRkKCd0aW5nbGUtbW9kYWxfX2Nsb3NlSWNvbicpXG4gICAgICAgICAgICB0aGlzLm1vZGFsQ2xvc2VCdG5JY29uLmlubmVySFRNTCA9ICfDlydcblxuICAgICAgICAgICAgdGhpcy5tb2RhbENsb3NlQnRuTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICAgICAgICAgIHRoaXMubW9kYWxDbG9zZUJ0bkxhYmVsLmNsYXNzTGlzdC5hZGQoJ3RpbmdsZS1tb2RhbF9fY2xvc2VMYWJlbCcpXG4gICAgICAgICAgICB0aGlzLm1vZGFsQ2xvc2VCdG5MYWJlbC5pbm5lckhUTUwgPSB0aGlzLm9wdHMuY2xvc2VMYWJlbFxuXG4gICAgICAgICAgICB0aGlzLm1vZGFsQ2xvc2VCdG4uYXBwZW5kQ2hpbGQodGhpcy5tb2RhbENsb3NlQnRuSWNvbilcbiAgICAgICAgICAgIHRoaXMubW9kYWxDbG9zZUJ0bi5hcHBlbmRDaGlsZCh0aGlzLm1vZGFsQ2xvc2VCdG5MYWJlbClcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG1vZGFsXG4gICAgICAgIHRoaXMubW9kYWxCb3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKVxuICAgICAgICB0aGlzLm1vZGFsQm94LmNsYXNzTGlzdC5hZGQoJ3RpbmdsZS1tb2RhbC1ib3gnKVxuXG4gICAgICAgIC8vIG1vZGFsIGJveCBjb250ZW50XG4gICAgICAgIHRoaXMubW9kYWxCb3hDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgICAgdGhpcy5tb2RhbEJveENvbnRlbnQuY2xhc3NMaXN0LmFkZCgndGluZ2xlLW1vZGFsLWJveF9fY29udGVudCcpXG5cbiAgICAgICAgdGhpcy5tb2RhbEJveC5hcHBlbmRDaGlsZCh0aGlzLm1vZGFsQm94Q29udGVudClcblxuICAgICAgICBpZiAodGhpcy5vcHRzLmNsb3NlTWV0aG9kcy5pbmRleE9mKCdidXR0b24nKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMubW9kYWwuYXBwZW5kQ2hpbGQodGhpcy5tb2RhbENsb3NlQnRuKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5tb2RhbC5hcHBlbmRDaGlsZCh0aGlzLm1vZGFsQm94KVxuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2J1aWxkRm9vdGVyKCkge1xuICAgICAgICB0aGlzLm1vZGFsQm94Rm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICAgICAgdGhpcy5tb2RhbEJveEZvb3Rlci5jbGFzc0xpc3QuYWRkKCd0aW5nbGUtbW9kYWwtYm94X19mb290ZXInKVxuICAgICAgICB0aGlzLm1vZGFsQm94LmFwcGVuZENoaWxkKHRoaXMubW9kYWxCb3hGb290ZXIpXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2JpbmRFdmVudHMoKSB7XG5cbiAgICAgICAgdGhpcy5fZXZlbnRzID0ge1xuICAgICAgICAgICAgY2xpY2tDbG9zZUJ0bjogdGhpcy5jbG9zZS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgY2xpY2tPdmVybGF5OiBfaGFuZGxlQ2xpY2tPdXRzaWRlLmJpbmQodGhpcyksXG4gICAgICAgICAgICByZXNpemU6IHRoaXMuY2hlY2tPdmVyZmxvdy5iaW5kKHRoaXMpLFxuICAgICAgICAgICAga2V5Ym9hcmROYXY6IF9oYW5kbGVLZXlib2FyZE5hdi5iaW5kKHRoaXMpXG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5vcHRzLmNsb3NlTWV0aG9kcy5pbmRleE9mKCdidXR0b24nKSAhPT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMubW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2V2ZW50cy5jbGlja0Nsb3NlQnRuKVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5tb2RhbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9ldmVudHMuY2xpY2tPdmVybGF5KVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgdGhpcy5fZXZlbnRzLnJlc2l6ZSlcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2V2ZW50cy5rZXlib2FyZE5hdilcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBfaGFuZGxlS2V5Ym9hcmROYXYoZXZlbnQpIHtcbiAgICAgICAgLy8gZXNjYXBlIGtleVxuICAgICAgICBpZiAodGhpcy5vcHRzLmNsb3NlTWV0aG9kcy5pbmRleE9mKCdlc2NhcGUnKSAhPT0gLTEgJiYgZXZlbnQud2hpY2ggPT09IDI3ICYmIHRoaXMuaXNPcGVuKCkpIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX2hhbmRsZUNsaWNrT3V0c2lkZShldmVudCkge1xuICAgICAgICAvLyBpZiBjbGljayBpcyBvdXRzaWRlIHRoZSBtb2RhbFxuICAgICAgICBpZiAodGhpcy5vcHRzLmNsb3NlTWV0aG9kcy5pbmRleE9mKCdvdmVybGF5JykgIT09IC0xICYmICFfZmluZEFuY2VzdG9yKGV2ZW50LnRhcmdldCwgJ3RpbmdsZS1tb2RhbCcpICYmXG4gICAgICAgIGV2ZW50LmNsaWVudFggPCB0aGlzLm1vZGFsLmNsaWVudFdpZHRoKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9maW5kQW5jZXN0b3IoZWwsIGNscykge1xuICAgICAgICB3aGlsZSAoKGVsID0gZWwucGFyZW50RWxlbWVudCkgJiYgIWVsLmNsYXNzTGlzdC5jb250YWlucyhjbHMpKTtcbiAgICAgICAgcmV0dXJuIGVsXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gX3VuYmluZEV2ZW50cygpIHtcbiAgICAgICAgaWYgKHRoaXMub3B0cy5jbG9zZU1ldGhvZHMuaW5kZXhPZignYnV0dG9uJykgIT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGFsQ2xvc2VCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9ldmVudHMuY2xpY2tDbG9zZUJ0bilcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm1vZGFsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2V2ZW50cy5jbGlja092ZXJsYXkpXG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLl9ldmVudHMucmVzaXplKVxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fZXZlbnRzLmtleWJvYXJkTmF2KVxuICAgIH1cblxuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gICAgLyogPT0gY29uZmlybSAqL1xuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgICAvLyBjb21pbmcgc29vblxuXG4gICAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgICAvKiA9PSBhbGVydCAqL1xuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgICAvLyBjb21pbmcgc29vblxuXG4gICAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbiAgICAvKiA9PSBoZWxwZXJzICovXG4gICAgLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuICAgIGZ1bmN0aW9uIGV4dGVuZCgpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBhcmd1bWVudHNbaV0pIHtcbiAgICAgICAgICAgICAgICBpZiAoYXJndW1lbnRzW2ldLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJndW1lbnRzWzBdW2tleV0gPSBhcmd1bWVudHNbaV1ba2V5XVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJndW1lbnRzWzBdXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd2hpY2hUcmFuc2l0aW9uRXZlbnQoKSB7XG4gICAgICAgIHZhciB0XG4gICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RpbmdsZS10ZXN0LXRyYW5zaXRpb24nKVxuICAgICAgICB2YXIgdHJhbnNpdGlvbnMgPSB7XG4gICAgICAgICAgICAndHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgICAgICAgICdPVHJhbnNpdGlvbic6ICdvVHJhbnNpdGlvbkVuZCcsXG4gICAgICAgICAgICAnTW96VHJhbnNpdGlvbic6ICd0cmFuc2l0aW9uZW5kJyxcbiAgICAgICAgICAgICdXZWJraXRUcmFuc2l0aW9uJzogJ3dlYmtpdFRyYW5zaXRpb25FbmQnXG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHQgaW4gdHJhbnNpdGlvbnMpIHtcbiAgICAgICAgICAgIGlmIChlbC5zdHlsZVt0XSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRyYW5zaXRpb25zW3RdXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuICAgIC8qID09IHJldHVybiAqL1xuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgICByZXR1cm4ge1xuICAgICAgICBtb2RhbDogTW9kYWxcbiAgICB9XG5cbn0pKVxuIiwiaW1wb3J0IERvbVV0aWwgZnJvbSBcIi4vVXRpbGl0aWVzL0RvbVV0aWxcIjtcbmltcG9ydCBVcmxVdGlsIGZyb20gXCIuL1V0aWxpdGllcy9VcmxVdGlsXCI7XG5pbXBvcnQgSHRtbExvYWRlciBmcm9tIFwiLi9VdGlsaXRpZXMvSHRtbExvYWRlclwiO1xuaW1wb3J0ICogYXMgdGluZ2xlIGZyb20gXCIuL1ZlbmRvci90aW5nbGUvZGlzdC90aW5nbGVcIjtcbmltcG9ydCBNYWtlUmVxdWVzdCBmcm9tIFwiLi9VdGlsaXRpZXMvTWFrZVJlcXVlc3RcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICB9XG5cbiAgICBleGVjdXRlKCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5zZXRMaXN0ZW5lcnMoKVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0TGlzdGVuZXJzKCkge1xuICAgICAgICB2YXIgdXNlcnNSb3dzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnVzZXInKTtcbiAgICAgICAgW10uc2xpY2VcbiAgICAgICAgICAgIC5jYWxsKHVzZXJzUm93cylcbiAgICAgICAgICAgIC5mb3JFYWNoKChlbGVtZW50OiBFbGVtZW50LCBpbmRleDogbnVtYmVyLCBhcnJheTogSFRNTEVsZW1lbnRbXSkgPT4ge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkb21VdGlsID0gbmV3IERvbVV0aWwoZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cmxVdGlsID0gbmV3IFVybFV0aWwoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1c2VySWQgPSBkb21VdGlsLmdldERhdGFBdHRyKCd1c2VyaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVzZXJVcmwgPSBgJHt1cmxVdGlsLmJhc2VVcmwoKX0vYXBpL21vZGFsL3VzZXI/aWQ9JHt1c2VySWR9YDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBIdG1sTG9hZGVyKCcjdXNlck1vZGFsJykubG9hZCh1c2VyVXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBNYWtlUmVxdWVzdCh1c2VyVXJsKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zZW5kKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyB0aW5nbGUubW9kYWwoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9vdGVyOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RpY2t5Rm9vdGVyOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlTWV0aG9kczogWydvdmVybGF5JywgJ2J1dHRvbicsICdlc2NhcGUnXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlTGFiZWw6IFwiQ2xvc2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNzc0NsYXNzOiBbJ2N1c3RvbS1jbGFzcy0xJywgJ2N1c3RvbS1jbGFzcy0yJ10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmVDbG9zZTogKCkgPT4gdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwuc2V0Q29udGVudChkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignQXVnaCwgdGhlcmUgd2FzIGFuIGVycm9yIScsIGVyci5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBmYWxzZVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG59XG5cbmRvY3VtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9ICgpID0+IHtcbiAgICBpZiAoZG9jdW1lbnQucmVhZHlTdGF0ZSA9PSBcImludGVyYWN0aXZlXCIpIHtcbiAgICAgICAgbmV3IEFwcCgpLmV4ZWN1dGUoKTtcbiAgICB9XG59O1xuIl19"}